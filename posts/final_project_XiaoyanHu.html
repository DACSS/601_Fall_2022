<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xiaoyan Hu">
<meta name="dcterms.date" content="2022-12-05">

<title>Final project: Calculating and visualizing texture profile analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="final_project_XiaoyanHu_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_project_XiaoyanHu_files/libs/quarto-html/quarto.js"></script>
<script src="final_project_XiaoyanHu_files/libs/quarto-html/popper.min.js"></script>
<script src="final_project_XiaoyanHu_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_project_XiaoyanHu_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_project_XiaoyanHu_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_project_XiaoyanHu_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_project_XiaoyanHu_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_project_XiaoyanHu_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_project_XiaoyanHu_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"></a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">tidy data</a></li>
  <li><a href="#calculation--" id="toc-calculation--" class="nav-link" data-scroll-target="#calculation--">Calculation -</a></li>
  </ul></li>
  <li><a href="#visualizition" id="toc-visualizition" class="nav-link" data-scroll-target="#visualizition">Visualizition</a></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection">Reflection</a>
  <ul class="collapse">
  <li><a href="#why-i-choose-this-project" id="toc-why-i-choose-this-project" class="nav-link" data-scroll-target="#why-i-choose-this-project">Why I choose this project</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final project: Calculating and visualizing texture profile analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">food sample</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xiaoyan Hu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 5, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<style>
details {
    border: 1px solid;
    border-radius: 10px;
    padding: .1em .5em 0;
    text-align: left;
}
</style>
<hr>
<div class="cell">

</div>
<details>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fmsb)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</details>
<section id="section" class="level1 tabset">
<h1 class="tabset"></h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>There is a growing demand on plant-based meat analogs due to ethical, environmental and health concerns associated associated with the production of real meat and seafood. Meat and seafood analogs should mimic the desirable appearance, texture, and flavor of the real versions. In this study, we investigated on the texture of animal meat analogs, expecially on their texture profile of adipose tissue(know as fat meat).</p>
<p>In this data, I have 5 samples. Control is beef fat.Sample 1-4 composed of different plant-based ingredients such as soybean oil, coconut oil, soybean protein and agar to combine them into a emulsion or gel that looks similar as fat meat under microscope. However, they still have huge differences on the macro texture.</p>
<p>Texture profile anaylsis mimics motion and force in human oral cavity. the measurement including two times of compression and raw data including time and corresponding time. From this data set, many other parameters can be calculated from the graph. The automatic calculation sometimes can be confusing and messy data have to be processed by excels and individual calculations.</p>
<p>Parameter including hardness, adhersiveness, resilience, cohesion and chewiness. The defenition and calculation will be introduced in below section.</p>
<p>In this report, the raw data of texture profile analysis will be tidied and calculated. The 5 parameter data will be calculated either from raw data or graph and will be visualized. Interpret of comparison in different samples will be performed. Using R may provide an efficient way to process the raw data with better visualization compare to traditional excel plotting and calculation.</p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>Raw TPA data is presented as time versus force. By plotting this graph, further texture parameters can be done by calculation.</p>
<section id="tidy-data" class="level3">
<h3 class="anchored" data-anchor-id="tidy-data">tidy data</h3>
<p>In this section, the raw data was reded in, pivoted and transformed into a new table as previewed below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read in data.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data1 = Texture Profile analysis of 5 samples including data of each time and force</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the cell_limits c=(upper left cell), c=(lower right cell)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>data1<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Users/cassie199/Desktop/22fall/DACSS601/601_Fall_2022/posts/_data/final_data.xlsx"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet=</span><span class="st">"TPAraw"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">range =</span> <span class="fu">cell_limits</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">10</span>)),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"control0time"</span>,<span class="st">"control0force"</span>,<span class="st">"S10time"</span>,<span class="st">"S10force"</span>,<span class="st">"S20time"</span>,<span class="st">"S20force"</span>,<span class="st">"S30time"</span>,<span class="st">"S30force"</span>,<span class="st">"S40time"</span>,<span class="st">"S40force"</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a row number which will help locate data below</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>data1<span class="ot">&lt;-</span><span class="fu">mutate</span>(data1, <span class="at">row_num =</span> <span class="fu">seq.int</span>(<span class="fu">nrow</span>(data1)))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                               </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#converting character data into numeric</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(data1, as.numeric))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#pivot data into 4 variables</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">&lt;-</span>data1<span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(control0force,S10force, S20force, S30force,S40force),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to =</span> <span class="st">"sampleforce"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">values_to =</span> <span class="st">"force1"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(sampleforce, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"sample"</span>, <span class="st">"type"</span>), <span class="at">sep =</span> <span class="st">"0"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#extract columns needed and form a clean data frame</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>TDdata<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> data2<span class="sc">$</span>control0time,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">force1 =</span> data2<span class="sc">$</span>force1,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sample =</span> data2<span class="sc">$</span>sample,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">row_num =</span> data2<span class="sc">$</span>row_num)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co">#preview of tidy data</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(TDdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   time force1  sample row_num
1 0.000   -0.1 control       1
2 0.000   -1.0      S1       1
3 0.000   -1.2      S2       1
4 0.000    1.0      S3       1
5 0.000    0.7      S4       1
6 0.005   -5.1 control       2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result_df = TDdata%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># group_by(sample)%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># arrange(time + sample)%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># mutate(force_T1 = lead(force1))%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#filter(force1&gt;0)%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a> <span class="co">#filter(force_T1 &lt;0)%&gt;%print()</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#df_1 = result_df %&gt;% filter(sample == "control")</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#df_2 = result_df %&gt;% filter(sample == "S1")</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#df_3 = result_df %&gt;% filter(sample == "S2")</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#df_4 = result_df %&gt;% filter(sample == "S3")</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#df_5 = result_df %&gt;% filter(sample == "S4")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

</section>
<section id="calculation--" class="level3">
<h3 class="anchored" data-anchor-id="calculation--">Calculation -</h3>
<p>Below is a sample graph of how raw data plotted out as time VS force looks like.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In this section, other parameter described above will be calculated</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Below includes a sample graph</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"/Users/cassie199/Desktop/22fall/DACSS601/601_Fall_2022/posts/TPA1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="601_Fall_2022/posts/TPA1.png" class="img-fluid" width="749"></p>
</div>
</div>
<p>In the texture profile analysis, the highest point of first peak represents the hardness of the sample.The F1 force is defined as hardness of sample. In below block, a function is written to filter out the maximum force of one sample. Below table in force column present the highest peak in each sample as the hardness.</p>
<p>find hardness F1</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hardness = F1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># group by sample and filter the sample you want to calculate</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the cumulative area by time and force in each row, this data will used in later section</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#slice out the maximum force</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#control F1#S1 F1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>f1func<span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area1=</span><span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(force1))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>df1<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'control'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>df2<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S1'</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>df3<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S2'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>df4<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S3'</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>df5<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S4'</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#merge sliced samples into a table</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>mergefunc<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>)))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>F1<span class="ot">&lt;-</span><span class="fu">mergefunc</span>(df1,df2,df3,df4,df5)<span class="sc">%&gt;%</span><span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 Ã— 5
# Groups:   sample [5]
   time  force1 sample  row_num area1[,1]
  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;int&gt;     &lt;dbl&gt;
1  2.35 24080.  control     470   12334. 
2  1.13    82.9 S1          227      45.7
3  1.14  1178.  S2          230     505. 
4  2.12  1032.  S3          424     624. 
5  1.06  2189.  S4          212     720. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRY &lt;- function(control,max_time,time){</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(TDdata%&gt;%group_by(sample)%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter(sample = 'control')%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(area2 = cumtrapz(time,force1))%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># mutate(force_t1 =lead(force1)))%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  F1%&gt;%select(force1, sample ,time) %&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rename(max_time = time) %&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a> <span class="co">#right_join(TDdata)%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(time&gt;max_time)%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(force1 &gt; 0)%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(force_t1&lt;0)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#} </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#TRY(control, max_time, time)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Resilience is defined as area b/area and can be understand as how much sample regain after first compression. And calculated as area b/area a. Therefore, the next trunk finds out the endpoint of first peak. the cumulative area from end of first peak minus cumulative area of the maximum force(calculated above) will be the area b.</p>
<p>find area b</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#function to find the endpoint of peak 1 is wroted as finding the first time point after F1 that cooresponding force cross 0. </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#lead function align the force in next time point, therefore, the first point where force+1 is negative, and force is positive, implies the first point cross 0, which is the first peak end point. </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#endpoint of first peak</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>endfunc<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area2 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&gt;</span> y)<span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">force_t1 =</span><span class="fu">lead</span>(force1))<span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force1 <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force_t1<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>df6<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'control'</span>, <span class="dv">470</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>df7<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S1'</span>, <span class="dv">227</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>df8<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S2'</span>, <span class="dv">230</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>df9<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S3'</span>,<span class="dv">424</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>df10<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S4'</span>, <span class="dv">212</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#merge sliced samples into a table</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>mergefunc2<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>)))</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>END1<span class="ot">&lt;-</span><span class="fu">mergefunc2</span>(df6,df7,df8,df9, df10)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#area b is calculated by cumulative area at end point minus cumulative area at F1</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>areab <span class="ot">=</span> F1 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(END1,<span class="at">by =</span> <span class="fu">c</span>( <span class="st">"sample"</span>))<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">areab =</span>  area2 <span class="sc">-</span>area1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The cohesion stands for How well the product withstands a second deformation relative to its resistance under the first deformation an calculated as area (d+e)/(a+b). Therefore, we still need to find the start and end point of peak 2.</p>
<p>In this section, similar functions were wrote to finding the function. The data was cutted after endpoint 1 to find the maximum which is the F2.</p>
<p>find F2</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding F2 by filtering the sample after the first peak and then slice tha maximum</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>F2func<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">area1 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&gt;</span> y)<span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(force1))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>df11<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'control'</span>, <span class="dv">551</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>df12<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S1'</span>, <span class="dv">259</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>df13<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S2'</span>, <span class="dv">268</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>df14<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S3'</span>, <span class="dv">587</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>df15<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S4'</span>, <span class="dv">320</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>F2<span class="ot">&lt;-</span> <span class="fu">mergefunc</span>(df11, df12, df13, df14, df15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The start point of second peak was filtered back to find the cross 0 point. And the end point is also selected by the cross 0 point after F2.</p>
<pre><code>find the start point of area d</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find the start point of area d</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>start2<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area3 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&lt;</span> y)<span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(row_num))<span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">force_t1 =</span><span class="fu">lead</span>(force1))<span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force1 <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force_t1<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>dfd1<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'control'</span>, <span class="dv">3408</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>dfd2<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S1'</span>, <span class="dv">2681</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>dfd3<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S2'</span>, <span class="dv">2688</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>dfd4<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S3'</span>, <span class="dv">3270</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>dfd5<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S4'</span>, <span class="dv">2631</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>mergefunc3<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>)))</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>start2<span class="ot">&lt;-</span><span class="fu">mergefunc3</span>(dfd1, dfd2,dfd3,dfd4,dfd5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>find the ending point of area e</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find the ending point of area e</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>END2func<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area4 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span>  </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&gt;</span>y)<span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">force_t1 =</span><span class="fu">lead</span>(force1))<span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force1 <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force_t1<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>dfd6<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'control'</span>,<span class="dv">3408</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>dfd7<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S1'</span>,<span class="dv">2681</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>dfd8<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S2'</span>,<span class="dv">2688</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>dfd9<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S3'</span>,<span class="dv">3270</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>dfd10<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S4'</span>,<span class="dv">2631</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>mergefunc4<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>)))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>END2<span class="ot">&lt;-</span><span class="fu">mergefunc4</span>(dfd6,dfd7,dfd8,dfd9,dfd10)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>areae <span class="ot">=</span> F2 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(END2,<span class="at">by =</span> <span class="fu">c</span>( <span class="st">"sample"</span>))<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">areae =</span>  area4 <span class="sc">-</span>area1)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>aread <span class="ot">=</span> F2 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(start2,<span class="at">by =</span> <span class="fu">c</span>( <span class="st">"sample"</span>))<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">aread =</span>  area1 <span class="sc">-</span>area3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<pre><code>Springiness is defined as how a product physically springs back at the second compression.

therefore, the critical point we need to find out from the data is the coordinate of F1, the time where area b ends, F2, and where the second peak starts and ends. After obtaining these data, the calculation can be performed.</code></pre>
<p>combine all calculated value into a new data frame</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all value calculated above are sorted into a new table</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gumminess = Hardness*cohesion</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Chewiness = Gumminess * Springiness</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>parameters<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sample_name =</span> F1<span class="sc">$</span>sample,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hardness =</span> F1<span class="sc">$</span>force1,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">resilience =</span> <span class="fu">c</span>(areab<span class="sc">$</span>area2<span class="sc">-</span>areab<span class="sc">$</span>area1),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cohesion =</span> <span class="fu">c</span>((aread<span class="sc">$</span>aread <span class="sc">+</span>areae<span class="sc">$</span>areae) <span class="sc">/</span> (F1<span class="sc">$</span>area1 <span class="sc">+</span>areab<span class="sc">$</span>areab)),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">springiness =</span> <span class="fu">c</span>((F2<span class="sc">$</span>time<span class="sc">-</span>start2<span class="sc">$</span>time)<span class="sc">/</span>F1<span class="sc">$</span>time))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>parameters<span class="ot">&lt;-</span>parameters<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">chewiness =</span> parameters<span class="sc">$</span>hardness <span class="sc">*</span> parameters<span class="sc">$</span>cohesion)<span class="sc">%&gt;%</span><span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sample_name hardness resilience  cohesion springiness   chewiness
1     control  24079.7  3800.8283 0.5426024   0.8848614 13065.70323
2          S1     82.9     5.3125 0.8855980   0.8938053    73.41607
3          S2   1177.8    60.7060 0.3251442   0.8995633   382.95482
4          S3   1031.9   275.1400 0.8644005   0.7754137   891.97485
5          S4   2189.4   208.8793 0.7663462   0.9289100  1677.83841</code></pre>
</div>
</div>
</section>
</section>
<section id="visualizition" class="level2">
<h2 class="anchored" data-anchor-id="visualizition">Visualizition</h2>
<p>In texture analysis, comparing the values sometimes can be difficult to interpret the data. By visualizing, we can easily compare the single parameters in each sample and analysis how the material brings the strength and weakness separately. We can also compare the overall similarity of each sample to the control ro select a good candidate to continue research on.</p>
<p>Below is an overview of control data. As we can see, all the parameters were calculated from this graph.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sample graph of control data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1, <span class="fu">aes</span>(<span class="at">x=</span> control0time, <span class="at">y=</span> control0force)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_XiaoyanHu_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>All the parameters was plotted in bar chart first to compare each single parameter individually. This helps understand the specific strength of each material. Control which is the beef sample shows good hardness implies the inner structure of beef provide a good support to the over all material. The lab created samples we can see that emulsion samples(S1 and S3) are less hard than gelled samples(S2 and S4) while solid coconut oil under room temperature(S3 and S4) are better than liquid soybean oil(S1 and S2)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bar chart need to include stat='identityâ€˜ which is basically telling ggplot2 you will provide the y-values for the barplot, rather than counting the aggregate number of rows for each x value, which is the default stat=count</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> hardness, <span class="at">fill =</span> hardness)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Hardness'</span>)<span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"royalblue"</span>, <span class="at">high =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_XiaoyanHu_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Resilience is how much the sample bounce back from the first compression. Still, the control sample raise most. And the soybean gelled emulsion (S3) remains highest. This indicates the liquid oil gives the best recovery to the gelling agent.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> resilience,<span class="at">fill =</span> resilience)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span> <span class="fu">scale_y_log10</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Resilience'</span>)<span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"hotpink3"</span>, <span class="at">high =</span> <span class="st">"lightpink"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_XiaoyanHu_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The cohesion measure how the sample stand at second compression, which can be understand as how much hardness remains in second compression. Some brittle sample may broke during this time. From the graph we can easily tell, emulsion samples (S1S3) have relative high cohesion under second compress.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> cohesion, <span class="at">fill =</span> cohesion)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Cohesion'</span>) <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"turquoise4"</span>, <span class="at">high =</span> <span class="st">"steelblue1"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_XiaoyanHu_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The springiness indicate the relative time sample bounce back. There was no significant differenceb between each samples.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> springiness, <span class="at">fill =</span> springiness)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>)  <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Springiness'</span>)<span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"cadetblue4"</span>, <span class="at">high =</span> <span class="st">"cadetblue1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_XiaoyanHu_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The chewiness expresses the overall behavior of second compression. Here we can see, our control have the relatively high chewiness while samples are gradually gaining chewiness by adding factors such as solid oil and gelling agent.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> chewiness, <span class="at">fill =</span> chewiness)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span>  <span class="fu">scale_y_log10</span> ()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'chewiness'</span>)<span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"mediumorchid4"</span>, <span class="at">high =</span> <span class="st">"plum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_XiaoyanHu_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The radar chart gives a better idea of overall balance overall samples. From the radar chart, we can easily understandthe control still have strength over power all lab-made samples, especially when some parameters were plotted in log scale. However, between samples, we can also differenciate that overall S3 and S4 have a similar area than S1 and S2. This indicates the solid fat contributes more to the fat structure instead of the gelling agent (S3,S4 is overall better than S1,S2). Also looking at S1 and S2, gelling agent provide much improvement while did not work in S3 and S4. The solid oil somehow restricted the impovement of gelling agent. Overall, S3 and S4 performed best and overall close the character of control.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>max<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'max'</span>,<span class="dv">25000</span>, <span class="dv">4000</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">15000</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>min<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'min'</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">10</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>parameters1<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="at">c =</span> min, <span class="at">c=</span>max, parameters, <span class="at">deparse.level =</span> <span class="dv">0</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>parameter2<span class="ot">&lt;-</span> <span class="fu">transform</span>(parameters1, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">hardness =</span> <span class="fu">as.numeric</span>(hardness),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">resilience =</span> <span class="fu">as.numeric</span>(resilience),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cohesion =</span> <span class="fu">as.numeric</span>(cohesion),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">springiness =</span> <span class="fu">as.numeric</span>(springiness),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">chewiness =</span> <span class="fu">as.numeric</span>(chewiness))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>parameters3<span class="ot">&lt;-</span>parameter2<span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hardnesslog =</span> <span class="fu">log10</span>(hardness))<span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chewinesslog =</span> <span class="fu">log10</span>(chewiness))<span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resiliencelog =</span> <span class="fu">log10</span>(resilience))</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>parameters3<span class="ot">&lt;-</span>parameters3[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>)]</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">radarchart</span>(parameters3,<span class="at">maxmin =</span> <span class="cn">FALSE</span>,<span class="at">cglwd =</span> <span class="fl">0.5</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">pcol  =</span> <span class="fu">c</span>(<span class="st">"white"</span>,<span class="st">"white"</span>,<span class="st">"blue"</span>,<span class="st">"pink4"</span>,<span class="st">"orchid"</span>,<span class="st">"turquoise3"</span>,<span class="st">"yellow"</span>),</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">plty =</span> <span class="dv">1</span>,<span class="at">palcex =</span> <span class="dv">5</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">pfcol =</span>  scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">"white"</span>,<span class="st">"white"</span>,<span class="st">"blue"</span>,<span class="st">"pink4"</span>,<span class="st">"orchid"</span>,<span class="st">"turquoise3"</span>,<span class="st">"yellow"</span>),<span class="fl">0.2</span>))</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"right"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"S1"</span>,<span class="st">"S2"</span>,<span class="st">"S3"</span>,<span class="st">"S4"</span>) ,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"pink4"</span>,<span class="st">"orchid"</span>,<span class="st">"turquoise3"</span>,<span class="st">"gold"</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_XiaoyanHu_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="reflection" class="level2">
<h2 class="anchored" data-anchor-id="reflection">Reflection</h2>
<section id="why-i-choose-this-project" class="level3">
<h3 class="anchored" data-anchor-id="why-i-choose-this-project">Why I choose this project</h3>
<p>In this project, I selected a measurement data that we used daily in our lab. I want to chose this data because the machine can calculate the value, however sometime with mistakes. In this case, we have to import the data into excel, plot it, find value we need among thousands of data point and then calculate. This process is boring and redunant. By learning r, I found it might be a food idea that I can find a easier way to calculated all this value automatically to avoid human labor. And by the time this programming works, the future data can be imported, organized and visualized automatically which can save much time. Therefore, I decided to work on this project.</p>
<p>###Difficultes I met By looking at others projects and examples in the class, I found most of them are aiming at visualization and analysis. However, in my case, the most heavy work was in calculation. The raw data was simple and easy to tidy, however, finding the significant values in this data requires a lot of work. The measurements were human tested samples and there are many interference data points. For example, I want to find the end point of the first peak, where force = 0. However, how would I select the point since the nears point to 0 may be 10, and the next wil be -10, where 0 doesnâ€™t actually have a physically point. In this case, I have to using functions to filter and understand where the value I want exactly and not taking in those interference points.</p>
<p>Also, reducing the redundant steps has also been a difficulty for me to solve. By learning functions, I found that repeated steps can be easily</p>
<p>Another thing I have learnt from this class and this project is how to brainstorm the steps that you reach to your final goals. My data looks like a simple data set but considering the interference, it became very difficult to make it accurate. More and more steps were added when i wrote the code and repeat and reduced. So there are tons of effort which may not been present in the code. The learning process was really interesting but tiring, with understanding varies packages and functions. The accumulation will make the future coding much more easier.</p>
<p>###Next step of this project</p>
<p>I havenâ€™t optimized the calculation into a best, easiest and shortest steps to calculate all the values which can be done in the future. Another problem I left was indexing of table into tables. This</p>
<p>Also, there might be a way to cooperate the sample ingredients into data presenting. However, most of my work was done in descriptions. It may also be difficult to visualize or make those numeric to consider about the ingredients.This could also be innovative in presenting scentific research results to help other understand.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In conclusion, this project calculated the value of texture analysis profile and visualized the data to compare the samples. This helps us to understant the single parameter and overall strenght and weakness of each sample and find the most close lab-made sample to our control.</p>
<p>In terms of R, this project help me helps me build up idea of how to approach data in a desired manner and how to make the coding easy and simple. Althought I havenâ€™t make it perfect in this project, it is a really great process to learn the idea with processing data.</p>
</section>
<section id="bibliography" class="level2">
<h2 class="anchored" data-anchor-id="bibliography">Bibliography</h2>
<ol type="1">
<li>Hu, X. and D. J. McClements (2022). â€œConstruction of plant-based adipose tissue using high internal phase emulsions and emulsion gels.â€ Innovative Food Science &amp; Emerging Technologies 78: 103016.</li>
<li>Centre for Indutrial, R. (2022). Texture Analysis And Texture Profile Analysis - Rheology Lab. 3)Wickham, H. and G. Grolemund (2016). R for Data Science: Import, Tidy, Transform, Visualize, and Model Data, Oâ€™Reilly Media.</li>
</ol>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb24" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final project: Calculating and visualizing texture profile analysis"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Xiaoyan Hu"</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "data analysis and visualization of lab-made adipose"</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "12/05/2022"</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - food sample</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;style&gt;</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>details {</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border</span>: <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span><span class="op">;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span>: <span class="dv">10</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">.1</span><span class="dt">em</span> <span class="dv">.5</span><span class="dt">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-align</span>: <span class="dv">left</span><span class="op">;</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/style&gt;</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r global_setting, echo = FALSE, message = FALSE, warning = FALSE}</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="cn">NA</span>,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> T</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Sys.setenv(</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   "RETICULATE_PYTHON" = "C:/Anaconda_Python_3/python.exe"</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load_packages, echo=T}</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fmsb)</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="fu"># {.tabset}</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction </span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>  There is a growing demand on plant-based meat analogs due to ethical, environmental and health concerns associated associated with the production of real meat and seafood. Meat and seafood analogs should mimic the desirable appearance, texture, and flavor of the real versions. In this study, we investigated on the texture of animal meat analogs, expecially on their texture profile of adipose tissue(know as fat meat). </span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>  In this data, I have 5 samples. Control is beef fat.Sample 1-4 composed of different plant-based ingredients such as soybean oil, coconut oil, soybean protein and agar to combine them into a emulsion or gel that looks similar as fat meat under microscope. However, they still have huge differences on the macro texture. </span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  Texture profile anaylsis mimics motion and force in human oral cavity. the measurement including two times of compression and raw data including time and corresponding time. From this data set, many other parameters can be calculated from the graph. The automatic calculation sometimes can be confusing and messy data have to be processed by excels and individual calculations.  </span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>  Parameter including hardness, adhersiveness, resilience, cohesion and chewiness. The defenition and calculation will be introduced in below section. </span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>  In this report, the raw data of texture profile analysis will be tidied and calculated.  The 5 parameter data will be calculated either from raw data or graph and will be visualized. Interpret of comparison in different samples will be performed. Using R may provide an efficient way to process the raw data with better visualization compare to traditional excel plotting and calculation. </span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data </span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>  Raw TPA data is presented as time versus force. By plotting this graph, further texture parameters can be done by calculation. </span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a><span class="fu">### tidy data</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>In this section, the raw data was reded in, pivoted and transformed into a new table as previewed below.</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r read in and pivot}</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a><span class="co">#read in data.</span></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a><span class="co"># data1 = Texture Profile analysis of 5 samples including data of each time and force</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a><span class="co"># the cell_limits c=(upper left cell), c=(lower right cell)</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>data1<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Users/cassie199/Desktop/22fall/DACSS601/601_Fall_2022/posts/_data/final_data.xlsx"</span>,</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet=</span><span class="st">"TPAraw"</span>,</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>                  <span class="at">range =</span> <span class="fu">cell_limits</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">10</span>)),</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>              <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"control0time"</span>,<span class="st">"control0force"</span>,<span class="st">"S10time"</span>,<span class="st">"S10force"</span>,<span class="st">"S20time"</span>,<span class="st">"S20force"</span>,<span class="st">"S30time"</span>,<span class="st">"S30force"</span>,<span class="st">"S40time"</span>,<span class="st">"S40force"</span>))</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a row number which will help locate data below</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>data1<span class="ot">&lt;-</span><span class="fu">mutate</span>(data1, <span class="at">row_num =</span> <span class="fu">seq.int</span>(<span class="fu">nrow</span>(data1)))</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>                               </span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="co">#converting character data into numeric</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(data1, as.numeric))</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a><span class="co">#pivot data into 4 variables</span></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">&lt;-</span>data1<span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(control0force,S10force, S20force, S30force,S40force),</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to =</span> <span class="st">"sampleforce"</span>,</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>                             <span class="at">values_to =</span> <span class="st">"force1"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(sampleforce, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"sample"</span>, <span class="st">"type"</span>), <span class="at">sep =</span> <span class="st">"0"</span>)</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a><span class="co">#extract columns needed and form a clean data frame</span></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>TDdata<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> data2<span class="sc">$</span>control0time,</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>                    <span class="at">force1 =</span> data2<span class="sc">$</span>force1,</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sample =</span> data2<span class="sc">$</span>sample,</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>                    <span class="at">row_num =</span> data2<span class="sc">$</span>row_num)</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a><span class="co">#preview of tidy data</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(TDdata)</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a><span class="co">#result_df = TDdata%&gt;%</span></span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a> <span class="co"># group_by(sample)%&gt;%</span></span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a> <span class="co"># arrange(time + sample)%&gt;%</span></span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a> <span class="co"># mutate(force_T1 = lead(force1))%&gt;%</span></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a><span class="co">#filter(force1&gt;0)%&gt;%</span></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a> <span class="co">#filter(force_T1 &lt;0)%&gt;%print()</span></span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a><span class="co">#df_1 = result_df %&gt;% filter(sample == "control")</span></span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a><span class="co">#df_2 = result_df %&gt;% filter(sample == "S1")</span></span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a><span class="co">#df_3 = result_df %&gt;% filter(sample == "S2")</span></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a><span class="co">#df_4 = result_df %&gt;% filter(sample == "S3")</span></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a><span class="co">#df_5 = result_df %&gt;% filter(sample == "S4")</span></span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculation -</span></span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>  Below is a sample graph of how raw data plotted out as time VS force looks like.</span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a><span class="co"># In this section, other parameter described above will be calculated</span></span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Below includes a sample graph</span></span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"/Users/cassie199/Desktop/22fall/DACSS601/601_Fall_2022/posts/TPA1.png"</span>)</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>  In the texture profile analysis, the highest point of first peak represents the hardness of the sample.The F1 force is defined as hardness of sample. In below block, a function is written to filter out the maximum force of one sample.  Below table in force column present the highest peak in each sample as the hardness.</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>find hardness F1</span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Hardness = F1</span></span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a><span class="co"># group by sample and filter the sample you want to calculate</span></span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the cumulative area by time and force in each row, this data will used in later section</span></span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a><span class="co">#slice out the maximum force</span></span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a><span class="co">#control F1#S1 F1</span></span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a>f1func<span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area1=</span><span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(force1))</span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a>df1<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'control'</span>)</span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a>df2<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S1'</span>)</span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>df3<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S2'</span>)</span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a>df4<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S3'</span>)</span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>df5<span class="ot">&lt;-</span><span class="fu">f1func</span>(<span class="st">'S4'</span>)</span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a><span class="co">#merge sliced samples into a table</span></span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a>mergefunc<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>, <span class="st">"area1"</span>)))</span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a>F1<span class="ot">&lt;-</span><span class="fu">mergefunc</span>(df1,df2,df3,df4,df5)<span class="sc">%&gt;%</span><span class="fu">print</span>()</span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a><span class="co">#TRY &lt;- function(control,max_time,time){</span></span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a><span class="co">#  return(TDdata%&gt;%group_by(sample)%&gt;%</span></span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter(sample = 'control')%&gt;%</span></span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(area2 = cumtrapz(time,force1))%&gt;%</span></span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a> <span class="co"># mutate(force_t1 =lead(force1)))%&gt;%</span></span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  F1%&gt;%select(force1, sample ,time) %&gt;%</span></span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a><span class="co"># rename(max_time = time) %&gt;%</span></span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a> <span class="co">#right_join(TDdata)%&gt;%</span></span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(time&gt;max_time)%&gt;%</span></span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(force1 &gt; 0)%&gt;%</span></span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(force_t1&lt;0)</span></span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a><span class="co">#} </span></span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a><span class="co">#TRY(control, max_time, time)</span></span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a>Resilience is defined as area b/area and can be understand as how much sample regain after first compression. And calculated as area b/area a.</span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a>Therefore, the next trunk finds out the endpoint of first peak. the cumulative area from end of first peak minus cumulative area of the maximum force(calculated above) will be the area b.</span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a>find area b    </span>
<span id="cb24-192"><a href="#cb24-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a><span class="co">#function to find the endpoint of peak 1 is wroted as finding the first time point after F1 that cooresponding force cross 0. </span></span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a><span class="co">#lead function align the force in next time point, therefore, the first point where force+1 is negative, and force is positive, implies the first point cross 0, which is the first peak end point. </span></span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a><span class="co">#endpoint of first peak</span></span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a>endfunc<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){</span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area2 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&gt;</span> y)<span class="sc">%&gt;%</span></span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">force_t1 =</span><span class="fu">lead</span>(force1))<span class="sc">%&gt;%</span></span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force1 <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-204"><a href="#cb24-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force_t1<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-205"><a href="#cb24-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>))</span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a>df6<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'control'</span>, <span class="dv">470</span>)</span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a>df7<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S1'</span>, <span class="dv">227</span>)</span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a>df8<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S2'</span>, <span class="dv">230</span>)</span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a>df9<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S3'</span>,<span class="dv">424</span>)</span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a>df10<span class="ot">&lt;-</span><span class="fu">endfunc</span>(<span class="st">'S4'</span>, <span class="dv">212</span>)</span>
<span id="cb24-217"><a href="#cb24-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-218"><a href="#cb24-218" aria-hidden="true" tabindex="-1"></a><span class="co">#merge sliced samples into a table</span></span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a>mergefunc2<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-222"><a href="#cb24-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-223"><a href="#cb24-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area2"</span>,<span class="st">"force_t1"</span>)))</span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a>END1<span class="ot">&lt;-</span><span class="fu">mergefunc2</span>(df6,df7,df8,df9, df10)</span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a><span class="co">#area b is calculated by cumulative area at end point minus cumulative area at F1</span></span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a>areab <span class="ot">=</span> F1 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(END1,<span class="at">by =</span> <span class="fu">c</span>( <span class="st">"sample"</span>))<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">areab =</span>  area2 <span class="sc">-</span>area1)</span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-230"><a href="#cb24-230" aria-hidden="true" tabindex="-1"></a>The cohesion stands for How well the product withstands a second deformation relative to its resistance under the first deformation an calculated as area (d+e)/(a+b). Therefore, we still need to find the start and end point of peak 2. </span>
<span id="cb24-231"><a href="#cb24-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-232"><a href="#cb24-232" aria-hidden="true" tabindex="-1"></a>In this section, similar functions were wrote to finding the function. The data was cutted after endpoint 1 to find the maximum which is the F2.</span>
<span id="cb24-233"><a href="#cb24-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-234"><a href="#cb24-234" aria-hidden="true" tabindex="-1"></a>find F2</span>
<span id="cb24-237"><a href="#cb24-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-238"><a href="#cb24-238" aria-hidden="true" tabindex="-1"></a><span class="co">#finding F2 by filtering the sample after the first peak and then slice tha maximum</span></span>
<span id="cb24-239"><a href="#cb24-239" aria-hidden="true" tabindex="-1"></a>F2func<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb24-240"><a href="#cb24-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb24-241"><a href="#cb24-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb24-242"><a href="#cb24-242" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">area1 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb24-243"><a href="#cb24-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&gt;</span> y)<span class="sc">%&gt;%</span></span>
<span id="cb24-244"><a href="#cb24-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(force1))</span>
<span id="cb24-245"><a href="#cb24-245" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-246"><a href="#cb24-246" aria-hidden="true" tabindex="-1"></a>df11<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'control'</span>, <span class="dv">551</span>)</span>
<span id="cb24-247"><a href="#cb24-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-248"><a href="#cb24-248" aria-hidden="true" tabindex="-1"></a>df12<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S1'</span>, <span class="dv">259</span>)</span>
<span id="cb24-249"><a href="#cb24-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-250"><a href="#cb24-250" aria-hidden="true" tabindex="-1"></a>df13<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S2'</span>, <span class="dv">268</span>)</span>
<span id="cb24-251"><a href="#cb24-251" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-252"><a href="#cb24-252" aria-hidden="true" tabindex="-1"></a>df14<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S3'</span>, <span class="dv">587</span>)</span>
<span id="cb24-253"><a href="#cb24-253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-254"><a href="#cb24-254" aria-hidden="true" tabindex="-1"></a>df15<span class="ot">&lt;-</span><span class="fu">F2func</span>(<span class="st">'S4'</span>, <span class="dv">320</span>)</span>
<span id="cb24-255"><a href="#cb24-255" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-256"><a href="#cb24-256" aria-hidden="true" tabindex="-1"></a>F2<span class="ot">&lt;-</span> <span class="fu">mergefunc</span>(df11, df12, df13, df14, df15)</span>
<span id="cb24-257"><a href="#cb24-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-258"><a href="#cb24-258" aria-hidden="true" tabindex="-1"></a>The start point of second peak was filtered back to find the cross 0 point. And the end point is also selected by the cross 0 point after F2.</span>
<span id="cb24-259"><a href="#cb24-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-260"><a href="#cb24-260" aria-hidden="true" tabindex="-1"></a><span class="in">    find the start point of area d</span></span>
<span id="cb24-261"><a href="#cb24-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb24-262"><a href="#cb24-262" aria-hidden="true" tabindex="-1"></a><span class="co">#find the start point of area d</span></span>
<span id="cb24-263"><a href="#cb24-263" aria-hidden="true" tabindex="-1"></a>start2<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb24-264"><a href="#cb24-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb24-265"><a href="#cb24-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb24-266"><a href="#cb24-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area3 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span></span>
<span id="cb24-267"><a href="#cb24-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&lt;</span> y)<span class="sc">%&gt;%</span></span>
<span id="cb24-268"><a href="#cb24-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(row_num))<span class="sc">%&gt;%</span></span>
<span id="cb24-269"><a href="#cb24-269" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">force_t1 =</span><span class="fu">lead</span>(force1))<span class="sc">%&gt;%</span></span>
<span id="cb24-270"><a href="#cb24-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force1 <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-271"><a href="#cb24-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force_t1<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-272"><a href="#cb24-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>))</span>
<span id="cb24-273"><a href="#cb24-273" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-274"><a href="#cb24-274" aria-hidden="true" tabindex="-1"></a>dfd1<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'control'</span>, <span class="dv">3408</span>)</span>
<span id="cb24-275"><a href="#cb24-275" aria-hidden="true" tabindex="-1"></a>dfd2<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S1'</span>, <span class="dv">2681</span>)</span>
<span id="cb24-276"><a href="#cb24-276" aria-hidden="true" tabindex="-1"></a>dfd3<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S2'</span>, <span class="dv">2688</span>)</span>
<span id="cb24-277"><a href="#cb24-277" aria-hidden="true" tabindex="-1"></a>dfd4<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S3'</span>, <span class="dv">3270</span>)</span>
<span id="cb24-278"><a href="#cb24-278" aria-hidden="true" tabindex="-1"></a>dfd5<span class="ot">&lt;-</span><span class="fu">start2</span>(<span class="st">'S4'</span>, <span class="dv">2631</span>)</span>
<span id="cb24-279"><a href="#cb24-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-280"><a href="#cb24-280" aria-hidden="true" tabindex="-1"></a>mergefunc3<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb24-281"><a href="#cb24-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb24-282"><a href="#cb24-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-283"><a href="#cb24-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-284"><a href="#cb24-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area3"</span>,<span class="st">"force_t1"</span>)))</span>
<span id="cb24-285"><a href="#cb24-285" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-286"><a href="#cb24-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-287"><a href="#cb24-287" aria-hidden="true" tabindex="-1"></a>start2<span class="ot">&lt;-</span><span class="fu">mergefunc3</span>(dfd1, dfd2,dfd3,dfd4,dfd5)</span>
<span id="cb24-288"><a href="#cb24-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-289"><a href="#cb24-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-290"><a href="#cb24-290" aria-hidden="true" tabindex="-1"></a>find the ending point of area e</span>
<span id="cb24-293"><a href="#cb24-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-294"><a href="#cb24-294" aria-hidden="true" tabindex="-1"></a><span class="co">#find the ending point of area e</span></span>
<span id="cb24-295"><a href="#cb24-295" aria-hidden="true" tabindex="-1"></a>END2func<span class="ot">&lt;-</span><span class="cf">function</span>(x, y){</span>
<span id="cb24-296"><a href="#cb24-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(TDdata<span class="sc">%&gt;%</span><span class="fu">group_by</span>(sample)<span class="sc">%&gt;%</span></span>
<span id="cb24-297"><a href="#cb24-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> x)<span class="sc">%&gt;%</span></span>
<span id="cb24-298"><a href="#cb24-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area4 =</span> <span class="fu">cumtrapz</span>(time,force1))<span class="sc">%&gt;%</span>  </span>
<span id="cb24-299"><a href="#cb24-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row_num <span class="sc">&gt;</span>y)<span class="sc">%&gt;%</span></span>
<span id="cb24-300"><a href="#cb24-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">force_t1 =</span><span class="fu">lead</span>(force1))<span class="sc">%&gt;%</span></span>
<span id="cb24-301"><a href="#cb24-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force1 <span class="sc">&gt;</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-302"><a href="#cb24-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(force_t1<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb24-303"><a href="#cb24-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>))</span>
<span id="cb24-304"><a href="#cb24-304" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-305"><a href="#cb24-305" aria-hidden="true" tabindex="-1"></a>dfd6<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'control'</span>,<span class="dv">3408</span>)</span>
<span id="cb24-306"><a href="#cb24-306" aria-hidden="true" tabindex="-1"></a>dfd7<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S1'</span>,<span class="dv">2681</span>)</span>
<span id="cb24-307"><a href="#cb24-307" aria-hidden="true" tabindex="-1"></a>dfd8<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S2'</span>,<span class="dv">2688</span>)</span>
<span id="cb24-308"><a href="#cb24-308" aria-hidden="true" tabindex="-1"></a>dfd9<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S3'</span>,<span class="dv">3270</span>)</span>
<span id="cb24-309"><a href="#cb24-309" aria-hidden="true" tabindex="-1"></a>dfd10<span class="ot">&lt;-</span><span class="fu">END2func</span>(<span class="st">'S4'</span>,<span class="dv">2631</span>)</span>
<span id="cb24-310"><a href="#cb24-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-311"><a href="#cb24-311" aria-hidden="true" tabindex="-1"></a>mergefunc4<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,c,d,e){</span>
<span id="cb24-312"><a href="#cb24-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a <span class="sc">%&gt;%</span><span class="fu">full_join</span>(b,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb24-313"><a href="#cb24-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(c,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-314"><a href="#cb24-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(d,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-315"><a href="#cb24-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(e,<span class="at">by =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"force1"</span>, <span class="st">"sample"</span>, <span class="st">"row_num"</span>,<span class="st">"area4"</span>,<span class="st">"force_t1"</span>)))</span>
<span id="cb24-316"><a href="#cb24-316" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-317"><a href="#cb24-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-318"><a href="#cb24-318" aria-hidden="true" tabindex="-1"></a>END2<span class="ot">&lt;-</span><span class="fu">mergefunc4</span>(dfd6,dfd7,dfd8,dfd9,dfd10)</span>
<span id="cb24-319"><a href="#cb24-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-320"><a href="#cb24-320" aria-hidden="true" tabindex="-1"></a>areae <span class="ot">=</span> F2 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(END2,<span class="at">by =</span> <span class="fu">c</span>( <span class="st">"sample"</span>))<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">areae =</span>  area4 <span class="sc">-</span>area1)</span>
<span id="cb24-321"><a href="#cb24-321" aria-hidden="true" tabindex="-1"></a>aread <span class="ot">=</span> F2 <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(start2,<span class="at">by =</span> <span class="fu">c</span>( <span class="st">"sample"</span>))<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">aread =</span>  area1 <span class="sc">-</span>area3)</span>
<span id="cb24-322"><a href="#cb24-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-323"><a href="#cb24-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-324"><a href="#cb24-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-325"><a href="#cb24-325" aria-hidden="true" tabindex="-1"></a><span class="in">    Springiness is defined as how a product physically springs back at the second compression.</span></span>
<span id="cb24-326"><a href="#cb24-326" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb24-327"><a href="#cb24-327" aria-hidden="true" tabindex="-1"></a><span class="in">    therefore, the critical point we need to find out from the data is the coordinate of F1, the time where area b ends, F2, and where the second peak starts and ends. After obtaining these data, the calculation can be performed.</span></span>
<span id="cb24-328"><a href="#cb24-328" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb24-329"><a href="#cb24-329" aria-hidden="true" tabindex="-1"></a>combine all calculated value into a new data frame</span>
<span id="cb24-332"><a href="#cb24-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-333"><a href="#cb24-333" aria-hidden="true" tabindex="-1"></a><span class="co"># all value calculated above are sorted into a new table</span></span>
<span id="cb24-334"><a href="#cb24-334" aria-hidden="true" tabindex="-1"></a><span class="co"># Gumminess = Hardness*cohesion</span></span>
<span id="cb24-335"><a href="#cb24-335" aria-hidden="true" tabindex="-1"></a><span class="co"># Chewiness = Gumminess * Springiness</span></span>
<span id="cb24-336"><a href="#cb24-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-337"><a href="#cb24-337" aria-hidden="true" tabindex="-1"></a>parameters<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sample_name =</span> F1<span class="sc">$</span>sample,</span>
<span id="cb24-338"><a href="#cb24-338" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hardness =</span> F1<span class="sc">$</span>force1,</span>
<span id="cb24-339"><a href="#cb24-339" aria-hidden="true" tabindex="-1"></a>                       <span class="at">resilience =</span> <span class="fu">c</span>(areab<span class="sc">$</span>area2<span class="sc">-</span>areab<span class="sc">$</span>area1),</span>
<span id="cb24-340"><a href="#cb24-340" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cohesion =</span> <span class="fu">c</span>((aread<span class="sc">$</span>aread <span class="sc">+</span>areae<span class="sc">$</span>areae) <span class="sc">/</span> (F1<span class="sc">$</span>area1 <span class="sc">+</span>areab<span class="sc">$</span>areab)),</span>
<span id="cb24-341"><a href="#cb24-341" aria-hidden="true" tabindex="-1"></a>                        <span class="at">springiness =</span> <span class="fu">c</span>((F2<span class="sc">$</span>time<span class="sc">-</span>start2<span class="sc">$</span>time)<span class="sc">/</span>F1<span class="sc">$</span>time))</span>
<span id="cb24-342"><a href="#cb24-342" aria-hidden="true" tabindex="-1"></a>parameters<span class="ot">&lt;-</span>parameters<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">chewiness =</span> parameters<span class="sc">$</span>hardness <span class="sc">*</span> parameters<span class="sc">$</span>cohesion)<span class="sc">%&gt;%</span><span class="fu">print</span>()</span>
<span id="cb24-343"><a href="#cb24-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-344"><a href="#cb24-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-345"><a href="#cb24-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-346"><a href="#cb24-346" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualizition</span></span>
<span id="cb24-347"><a href="#cb24-347" aria-hidden="true" tabindex="-1"></a>In texture analysis, comparing the values sometimes can be difficult to interpret the data. By visualizing, we can easily compare the single parameters in each sample and analysis how the material brings the strength and weakness separately. We can also compare the overall similarity of each sample to the control ro select a good candidate to continue research on. </span>
<span id="cb24-348"><a href="#cb24-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-349"><a href="#cb24-349" aria-hidden="true" tabindex="-1"></a>Below is an overview of control data. As we can see, all the parameters were calculated from this graph. </span>
<span id="cb24-350"><a href="#cb24-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-353"><a href="#cb24-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-354"><a href="#cb24-354" aria-hidden="true" tabindex="-1"></a><span class="co">#sample graph of control data</span></span>
<span id="cb24-355"><a href="#cb24-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-356"><a href="#cb24-356" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data1, <span class="fu">aes</span>(<span class="at">x=</span> control0time, <span class="at">y=</span> control0force)) <span class="sc">+</span></span>
<span id="cb24-357"><a href="#cb24-357" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb24-358"><a href="#cb24-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-359"><a href="#cb24-359" aria-hidden="true" tabindex="-1"></a>All the parameters was plotted in bar chart first to compare each single parameter individually. This helps understand the specific strength of each material. </span>
<span id="cb24-360"><a href="#cb24-360" aria-hidden="true" tabindex="-1"></a>Control which is the beef sample shows good hardness implies the inner structure of beef provide a good support to the over all material. The lab created samples we can see that emulsion samples(S1 and S3) are less hard than gelled samples(S2 and S4) while solid coconut oil under room temperature(S3 and S4) are better than liquid soybean oil(S1 and S2)</span>
<span id="cb24-363"><a href="#cb24-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-364"><a href="#cb24-364" aria-hidden="true" tabindex="-1"></a><span class="co">#bar chart need to include stat='identityâ€˜ which is basically telling ggplot2 you will provide the y-values for the barplot, rather than counting the aggregate number of rows for each x value, which is the default stat=count</span></span>
<span id="cb24-365"><a href="#cb24-365" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> hardness, <span class="at">fill =</span> hardness)) <span class="sc">+</span></span>
<span id="cb24-366"><a href="#cb24-366" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span> </span>
<span id="cb24-367"><a href="#cb24-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb24-368"><a href="#cb24-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Hardness'</span>)<span class="sc">+</span> </span>
<span id="cb24-369"><a href="#cb24-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"royalblue"</span>, <span class="at">high =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb24-370"><a href="#cb24-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-371"><a href="#cb24-371" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb24-372"><a href="#cb24-372" aria-hidden="true" tabindex="-1"></a>Resilience is how much the sample bounce back from the first compression. Still, the control sample raise most. And the soybean gelled emulsion (S3) remains highest. This indicates the liquid oil gives the best recovery to the gelling agent.</span>
<span id="cb24-375"><a href="#cb24-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-376"><a href="#cb24-376" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> resilience,<span class="at">fill =</span> resilience)) <span class="sc">+</span></span>
<span id="cb24-377"><a href="#cb24-377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span> <span class="fu">scale_y_log10</span>()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Resilience'</span>)<span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"hotpink3"</span>, <span class="at">high =</span> <span class="st">"lightpink"</span>)</span>
<span id="cb24-378"><a href="#cb24-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-379"><a href="#cb24-379" aria-hidden="true" tabindex="-1"></a>The cohesion measure how the sample stand at second compression, which can be understand as how much hardness remains in second compression. Some brittle sample may broke during this time. From the graph we can easily tell, emulsion samples (S1S3) have relative high cohesion under second compress. </span>
<span id="cb24-382"><a href="#cb24-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-383"><a href="#cb24-383" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> cohesion, <span class="at">fill =</span> cohesion)) <span class="sc">+</span></span>
<span id="cb24-384"><a href="#cb24-384" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Cohesion'</span>) <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"turquoise4"</span>, <span class="at">high =</span> <span class="st">"steelblue1"</span>) </span>
<span id="cb24-385"><a href="#cb24-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-386"><a href="#cb24-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-387"><a href="#cb24-387" aria-hidden="true" tabindex="-1"></a>The springiness indicate the relative time sample bounce back. There was no significant differenceb between each samples. </span>
<span id="cb24-390"><a href="#cb24-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-391"><a href="#cb24-391" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> springiness, <span class="at">fill =</span> springiness)) <span class="sc">+</span></span>
<span id="cb24-392"><a href="#cb24-392" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>)  <span class="sc">+</span></span>
<span id="cb24-393"><a href="#cb24-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Springiness'</span>)<span class="sc">+</span> </span>
<span id="cb24-394"><a href="#cb24-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"cadetblue4"</span>, <span class="at">high =</span> <span class="st">"cadetblue1"</span>)</span>
<span id="cb24-395"><a href="#cb24-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-396"><a href="#cb24-396" aria-hidden="true" tabindex="-1"></a>The chewiness expresses the overall behavior of second compression. Here we can see, our control have the relatively high chewiness while samples are gradually gaining chewiness by adding factors such as solid oil and gelling agent. </span>
<span id="cb24-399"><a href="#cb24-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-400"><a href="#cb24-400" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(parameters, <span class="fu">aes</span>(<span class="at">x=</span> sample_name, <span class="at">y=</span> chewiness, <span class="at">fill =</span> chewiness)) <span class="sc">+</span></span>
<span id="cb24-401"><a href="#cb24-401" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>,<span class="at">colour =</span> <span class="st">'black'</span>) <span class="sc">+</span>  <span class="fu">scale_y_log10</span> ()<span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'chewiness'</span>)<span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"mediumorchid4"</span>, <span class="at">high =</span> <span class="st">"plum"</span>)</span>
<span id="cb24-402"><a href="#cb24-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-403"><a href="#cb24-403" aria-hidden="true" tabindex="-1"></a>The radar chart gives a better idea of overall balance overall samples. From the radar chart, we can easily understandthe control still have strength over power all lab-made samples, especially when some parameters were plotted in log scale. However, between samples, we can also differenciate that overall S3 and S4 have a similar area than S1 and S2. This indicates the solid fat contributes more to the fat structure instead of the gelling agent (S3,S4 is overall better than S1,S2). Also looking at S1 and S2, gelling agent provide much improvement  while did not work in S3 and S4. The solid oil somehow restricted the impovement of gelling agent. Overall, S3 and S4 performed best and overall close the character of control. </span>
<span id="cb24-406"><a href="#cb24-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-407"><a href="#cb24-407" aria-hidden="true" tabindex="-1"></a>max<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'max'</span>,<span class="dv">25000</span>, <span class="dv">4000</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">15000</span>)</span>
<span id="cb24-408"><a href="#cb24-408" aria-hidden="true" tabindex="-1"></a>min<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'min'</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">10</span>)</span>
<span id="cb24-409"><a href="#cb24-409" aria-hidden="true" tabindex="-1"></a>parameters1<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="at">c =</span> min, <span class="at">c=</span>max, parameters, <span class="at">deparse.level =</span> <span class="dv">0</span>)</span>
<span id="cb24-410"><a href="#cb24-410" aria-hidden="true" tabindex="-1"></a>parameter2<span class="ot">&lt;-</span> <span class="fu">transform</span>(parameters1, </span>
<span id="cb24-411"><a href="#cb24-411" aria-hidden="true" tabindex="-1"></a>          <span class="at">hardness =</span> <span class="fu">as.numeric</span>(hardness),</span>
<span id="cb24-412"><a href="#cb24-412" aria-hidden="true" tabindex="-1"></a>          <span class="at">resilience =</span> <span class="fu">as.numeric</span>(resilience),</span>
<span id="cb24-413"><a href="#cb24-413" aria-hidden="true" tabindex="-1"></a>          <span class="at">cohesion =</span> <span class="fu">as.numeric</span>(cohesion),</span>
<span id="cb24-414"><a href="#cb24-414" aria-hidden="true" tabindex="-1"></a>          <span class="at">springiness =</span> <span class="fu">as.numeric</span>(springiness),</span>
<span id="cb24-415"><a href="#cb24-415" aria-hidden="true" tabindex="-1"></a>          <span class="at">chewiness =</span> <span class="fu">as.numeric</span>(chewiness))</span>
<span id="cb24-416"><a href="#cb24-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-417"><a href="#cb24-417" aria-hidden="true" tabindex="-1"></a>parameters3<span class="ot">&lt;-</span>parameter2<span class="sc">%&gt;%</span></span>
<span id="cb24-418"><a href="#cb24-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hardnesslog =</span> <span class="fu">log10</span>(hardness))<span class="sc">%&gt;%</span></span>
<span id="cb24-419"><a href="#cb24-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chewinesslog =</span> <span class="fu">log10</span>(chewiness))<span class="sc">%&gt;%</span></span>
<span id="cb24-420"><a href="#cb24-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resiliencelog =</span> <span class="fu">log10</span>(resilience))</span>
<span id="cb24-421"><a href="#cb24-421" aria-hidden="true" tabindex="-1"></a>parameters3<span class="ot">&lt;-</span>parameters3[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>)]</span>
<span id="cb24-422"><a href="#cb24-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">radarchart</span>(parameters3,<span class="at">maxmin =</span> <span class="cn">FALSE</span>,<span class="at">cglwd =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-423"><a href="#cb24-423" aria-hidden="true" tabindex="-1"></a>             <span class="at">pcol  =</span> <span class="fu">c</span>(<span class="st">"white"</span>,<span class="st">"white"</span>,<span class="st">"blue"</span>,<span class="st">"pink4"</span>,<span class="st">"orchid"</span>,<span class="st">"turquoise3"</span>,<span class="st">"yellow"</span>),</span>
<span id="cb24-424"><a href="#cb24-424" aria-hidden="true" tabindex="-1"></a>             <span class="at">plty =</span> <span class="dv">1</span>,<span class="at">palcex =</span> <span class="dv">5</span>,</span>
<span id="cb24-425"><a href="#cb24-425" aria-hidden="true" tabindex="-1"></a>              <span class="at">pfcol =</span>  scales<span class="sc">::</span><span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">"white"</span>,<span class="st">"white"</span>,<span class="st">"blue"</span>,<span class="st">"pink4"</span>,<span class="st">"orchid"</span>,<span class="st">"turquoise3"</span>,<span class="st">"yellow"</span>),<span class="fl">0.2</span>))</span>
<span id="cb24-426"><a href="#cb24-426" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-427"><a href="#cb24-427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"right"</span>,</span>
<span id="cb24-428"><a href="#cb24-428" aria-hidden="true" tabindex="-1"></a>                    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"control"</span>,<span class="st">"S1"</span>,<span class="st">"S2"</span>,<span class="st">"S3"</span>,<span class="st">"S4"</span>) ,</span>
<span id="cb24-429"><a href="#cb24-429" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"pink4"</span>,<span class="st">"orchid"</span>,<span class="st">"turquoise3"</span>,<span class="st">"gold"</span>)</span>
<span id="cb24-430"><a href="#cb24-430" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb24-431"><a href="#cb24-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-432"><a href="#cb24-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-433"><a href="#cb24-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-434"><a href="#cb24-434" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reflection</span></span>
<span id="cb24-435"><a href="#cb24-435" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why I choose this project</span></span>
<span id="cb24-436"><a href="#cb24-436" aria-hidden="true" tabindex="-1"></a>In this project, I selected a measurement data that we used daily in our lab. I want to chose this data because the machine can calculate the value, however sometime with mistakes. In this case, we have to import the data into excel, plot it, find value we need among thousands of data point and then calculate. This process is boring and redunant. By learning r, I found it might be a food idea that I can find a easier way to calculated all this value automatically to avoid human labor. And by the time this programming works, the future data can be imported, organized and visualized automatically which can save much time. Therefore, I decided to work on this project. </span>
<span id="cb24-437"><a href="#cb24-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-438"><a href="#cb24-438" aria-hidden="true" tabindex="-1"></a>###Difficultes I met</span>
<span id="cb24-439"><a href="#cb24-439" aria-hidden="true" tabindex="-1"></a>By looking at others projects and examples in the class, I found most of them are aiming at visualization and analysis. However, in my case, the most heavy work was in calculation. The raw data was simple and easy to tidy, however, finding the significant values in this data requires a lot of work. The measurements were human tested samples and there are many interference data points. For example, I want to find the end point of the first peak, where force = 0. However, how would I select the point since the nears point to 0 may be 10, and the next wil be -10, where 0 doesn't actually have a physically point. In this case, I have to using functions to filter and understand where the value I want exactly and not taking in those interference points. </span>
<span id="cb24-440"><a href="#cb24-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-441"><a href="#cb24-441" aria-hidden="true" tabindex="-1"></a>Also, reducing the redundant steps has also been a difficulty for me to solve. By learning functions, I found that repeated steps can be easily </span>
<span id="cb24-442"><a href="#cb24-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-443"><a href="#cb24-443" aria-hidden="true" tabindex="-1"></a>  Another thing I have learnt from this class and this project is how to brainstorm the steps that you reach to your final goals. My data looks like a simple data set but considering the interference, it became very difficult to make it accurate. More and more steps were added when i wrote the code and repeat and reduced. So there are tons of effort which may not been present in the code. The learning process was really interesting but tiring, with understanding varies packages and functions. The accumulation will make the future coding much more easier. </span>
<span id="cb24-444"><a href="#cb24-444" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-445"><a href="#cb24-445" aria-hidden="true" tabindex="-1"></a>###Next step of this project</span>
<span id="cb24-446"><a href="#cb24-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-447"><a href="#cb24-447" aria-hidden="true" tabindex="-1"></a>I haven't optimized the calculation into a best, easiest and shortest steps to calculate all the values which can be done in the future. Another problem I left was indexing of table into tables. This</span>
<span id="cb24-448"><a href="#cb24-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-449"><a href="#cb24-449" aria-hidden="true" tabindex="-1"></a>Also, there might be a way to cooperate the sample ingredients into data presenting. However, most of my work was done in descriptions. It may also be difficult to visualize or make those numeric to consider about the ingredients.This could also be innovative in presenting scentific research results to help other understand. </span>
<span id="cb24-450"><a href="#cb24-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-451"><a href="#cb24-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-452"><a href="#cb24-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-453"><a href="#cb24-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb24-454"><a href="#cb24-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-455"><a href="#cb24-455" aria-hidden="true" tabindex="-1"></a>In conclusion, this project calculated the value of texture analysis profile and visualized the data to compare the samples. This helps us to understant the single parameter and overall strenght and weakness of each sample and find the most close lab-made sample to our control. </span>
<span id="cb24-456"><a href="#cb24-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-457"><a href="#cb24-457" aria-hidden="true" tabindex="-1"></a>In terms of R, this project help me helps me build up idea of how to approach data in a desired manner and how to make the coding easy and simple. Althought I haven't make it perfect in this project, it is a really great process to learn the idea with processing data. </span>
<span id="cb24-458"><a href="#cb24-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-459"><a href="#cb24-459" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bibliography</span></span>
<span id="cb24-460"><a href="#cb24-460" aria-hidden="true" tabindex="-1"></a>1) Hu, X. and D. J. McClements (2022). "Construction of plant-based adipose tissue using high internal phase emulsions and emulsion gels." Innovative Food Science &amp; Emerging Technologies 78: 103016.</span>
<span id="cb24-461"><a href="#cb24-461" aria-hidden="true" tabindex="-1"></a>2) Centre for Indutrial, R. (2022). Texture Analysis And Texture Profile Analysis - Rheology Lab.</span>
<span id="cb24-462"><a href="#cb24-462" aria-hidden="true" tabindex="-1"></a>3)Wickham, H. and G. Grolemund (2016). R for Data Science: Import, Tidy, Transform, Visualize, and Model Data, O'Reilly Media.</span>
<span id="cb24-463"><a href="#cb24-463" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-464"><a href="#cb24-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-465"><a href="#cb24-465" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb24-466"><a href="#cb24-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-467"><a href="#cb24-467" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb24-468"><a href="#cb24-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-469"><a href="#cb24-469" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb24-470"><a href="#cb24-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-471"><a href="#cb24-471" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>